<!DOCTYPE html>
<html lang="de">
   <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>padELO Umkleide Dashboard | WM Padel GmbH</title>
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" />
      <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css" rel="stylesheet" />
      <link rel="preconnect" href="https://fonts.googleapis.com" />
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
      <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Lobster&display=swap" rel="stylesheet" />
      <link href="/css/style.css" rel="stylesheet" />
      <link rel="icon" type="image/x-icon" href="/img/favicon.png" />
      <style>
         * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
         }

         body {
            transform: rotate(90deg);
            transform-origin: center center;
            width: 100vh;
            height: 100vw;
            position: fixed;
            top: 50%;
            left: 50%;
            margin-top: -50vw;
            margin-left: -50vh;
            overflow: hidden;
            background: #000;
            font-family: "Inter", sans-serif;
         }
         .content-area {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #000;
         }

         .image-container {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
         }

         .display-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            position: absolute;
            top: 0;
            left: 0;
            opacity: 0;
            transition: opacity 1s ease-in-out;
         }

         .display-image.active {
            opacity: 1;
         }
      </style>
   </head>
   <body>
      <div class="content-area">
         <div class="image-container" id="imageContainer">
            <img src="/img/padelcamp-promotion.jpeg" alt="Padel Sports Club" class="display-image active" id="fallbackImage" />
         </div>
      </div>

      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
      <script>
         (async function() {
            try {
               const res = await fetch('/api/umkleide-images');
               const data = await res.json();

               if (!data.images || data.images.length === 0) return;

               const container = document.getElementById('imageContainer');
               const fallback = document.getElementById('fallbackImage');

               // Preload all images
               const loaded = [];
               for (const src of data.images) {
                  const img = await new Promise((resolve, reject) => {
                     const el = new Image();
                     el.onload = () => resolve(el);
                     el.onerror = () => reject();
                     el.src = src;
                     el.className = 'display-image';
                     el.alt = 'Umkleide Display';
                  });
                  loaded.push(img);
               }

               if (loaded.length === 0) return;

               // Remove fallback, add loaded images
               fallback.remove();
               loaded.forEach(img => container.appendChild(img));

               // Show first image
               let current = 0;
               loaded[0].classList.add('active');

               if (loaded.length === 1) return;

               // Cycle through images
               setInterval(() => {
                  loaded[current].classList.remove('active');
                  current = (current + 1) % loaded.length;
                  loaded[current].classList.add('active');
               }, data.interval * 1000);
            } catch (e) {
               // Fallback image stays visible
            }
         })();
      </script>
   </body>
</html>
